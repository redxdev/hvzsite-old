{# src/Hvz/GameBundle/Resources/views/page.html.twig #}
{% extends 'HvzGameBundle::base.html.twig' %}

{% block components %}
	{{ parent() }}

	<link rel="import" href="{{ asset('bundles/hvzgame/components/core-scaffold-custom/core-scaffold-custom.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/components/core-header-panel/core-header-panel.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/components/core-menu/core-menu.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/components/core-menu/core-submenu.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/components/core-item/core-item.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/components/paper-shadow/paper-shadow.html') }}">
{% endblock %}

{% block body %}
	{{ parent() }}

	<core-scaffold>
		<core-header-panel navigation flex mode="seamed">
			<core-toolbar>HvZ</core-toolbar>
			<core-menu theme="core-light-theme" selected="{{ navigation.selected }}">
				{% for link in navigation.links %}
					<core-item id="menu-{{ link.id }}" icon="{{ link.icon }}" label="{{ link.label }}"></core-item>
				{% endfor %}

				{% if navigation.admin is not null %}
					<core-submenu icon="settings" label="Administration">
						{% for link in navigation.admin %}
							<core-item id="menu-admin-{{ link.id }}" icon="{{ link.icon }}" label="{{ link.label }}"></core-item>
						{% endfor %}
					</core-submenu>
				{% endif %}

				{% if app.user %}
					<core-submenu icon="account-box" label="{{ app.user.fullname | escape }}">
						<core-item id="menu-profile" label="Profile"></core-item>
						<core-item id="menu-logout" label="Logout"></core-item>
					</core-submenu>
				{% else %}
					<core-submenu icon="account-box" label="Account">
						<core-item id="menu-login" label="Login"></core-item>
						<core-item id="menu-register" label="Register"></core-item>
					</core-submenu>
				{% endif %}
			</core-menu>
		</core-header-panel>

		<div id="page-toolbar" tool>
			{% block toolbar %}
				{{ navigation.links[navigation.selected].label }}
			{% endblock %}
		</div>

		<div id="content">
			{% block content %}
			{% endblock %}
		</div>
	</core-scaffold>
{% endblock %}

{% block body_javascripts %}
	{{ parent() }}

	<script>
		$(function() {
			{% for link in navigation.links %}
				{% if loop.index0 != navigation.selected %}
					$("#menu-{{ link.id }}").click(function() {
						window.location = "{{ link.link }}";
					});
				{% endif %}
			{% endfor %}

			{% if navigation.admin is not null %}
				{% for link in navigation.admin %}
					$("#menu-admin-{{ link.id }}").click(function() {
						window.location = "{{ link.link }}";
					});
				{% endfor %}
			{% endif %}

			{% if app.user %}
				$("#menu-profile").click(function() {
					window.location = "{{ path('hvz_profile') }}";
				});

				$("#menu-logout").click(function() {
					window.location = "{{ path('hvz_auth_logout') }}";
				});
			{% else %}
				$("#menu-login").click(function() {
					window.location = "{{ path('hvz_auth_login') }}";
				});

				$("#menu-register").click(function() {
					window.location = "{{ path('hvz_auth_register') }}";
				});
			{% endif %}
		});
	</script>
{% endblock %}
