{# src/Hvz/GameBundle/Resources/views/Game/players.html.twig #}
{% extends 'HvzGameBundle::page.html.twig' %}

{% block stylesheets %}
	{{ parent() }}

	<style>
		div.player-info {
			margin-left: 10px;
		}
	</style>
{% endblock %}

{% block components %}
	{{ parent() }}

	<link rel="import" href="{{ asset('bundles/hvzgame/bower_components/paper-button/paper-button.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/bower_components/core-icon/core-icon.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/bower_components/core-tooltip/core-tooltip.html') }}">
	<link rel="import" href="{{ asset('bundles/hvzgame/bower_components/paper-input/paper-input.html') }}">
{% endblock %}

{% block toolbar %}
	<span flex>{{ parent() }}</span>
{% endblock %}

{% block content %}
	{{ parent() }}

	<div horizontal layout center center-justified>
		<core-icon icon="filter"></core-icon>
		<a href="{{ path('hvz_players') }}"><paper-button label="Team"></paper-button></a>
		<a href="{{ path('hvz_players', {'sort': 'clan'}) }}"><paper-button label="Clan"></paper-button></a>
	</div>

	<div horizontal layout center center-justified>
		<div class="card">
			<paper-shadow z="1"></paper-shadow>
			<div class="card-internal">
				<form id="search_form" action="{{ path('hvz_players_search') }}" method="get">
					<input type="hidden" id="search_term_hidden" name="term">
				</form>

				<div horizontal layout center wrap center-justified>
					<paper-input label="Search" floatingLabel id="search_term"></paper-input>
					<div>
						<paper-button label="Search" raisedButton onclick="search()"></paper-button>
					</div>
				</div>
			</div>
		</div>
	</div>

	{% for player in players %}
		<div class="card {% if player.team == 'human' %}card-human{% else %}card-zombie{% endif %}" horizontal layout>
			<paper-shadow z="1"></paper-shadow>
			<div class="card-internal" horizontal layout wrap>
				<div class="card" style="width: 100px; height: 100px;" vertical layout center center-justified>
					<paper-shadow z="2"></paper-shadow>
					<div class="card-internal">
						{% if player.avatar %}
							<img src="{{ asset(player.avatar) }}" alt="avatar" class="avatar">
						{% else %}
							<img src="holder.js/100x100" alt="avatar" class="avatar">
						{% endif %}
					</div>
				</div>
				<div class="player-info card-section">
					<h3 class="header" style="color: black;">{{ player.fullname }}</h3>
					<p><strong>Tags: </strong> {{ player.tags }}</p>
					<p><strong>Clan:</strong> {{ player.clan | default('none') }}</p>
				</div>
				<div class="card-section" horizontal layout wrap>
					{% for badge in player.badges %}
						<core-tooltip class="badge">
							<div>
								<img src="{{ asset('bundles/hvzgame/images/badges/' ~ badge.image) }}"
									alt="{{ badge.name }} badge">
							</div>
							<div tip>
								<p>{{ badge.name }}</p>
								<p>{{ badge.description }}</p>
							</div>
						</core-tooltip>
					{% endfor %}
				</div>
			</div>
		</div>
	{% endfor %}

	{% if previous_page is defined or next_page is defined %}
		<div horizontal layout center center-justified>
			<div class="card">
				<paper-shadow z="1"></paper-shadow>
				<div class="card-internal" horizontal layout center wrap center-justified>
					{% if previous_page is defined and previous_page != -1 %}
						<a href="{{ path('hvz_players', {'page': previous_page}) }}"><paper-button label="<<"></paper-button></a>
					{% endif %}
					{% if next_page is defined and next_page != -1 %}
						<a href="{{ path('hvz_players', {'page': next_page}) }}"><paper-button label=">>"></paper-button></a>
					{% endif %}
				</div>
			</div>
		</div>
	{% endif %}
{% endblock %}

{% block body_javascripts %}
	{{ parent() }}

	<script src="http://cdnjs.cloudflare.com/ajax/libs/holder/2.3.1/holder.min.js"></script>

	<script>
		function search() {
			$("#search_term_hidden").val($("#search_term").val());
			$("#search_form").submit();
		}
	</script>
{% endblock %}
